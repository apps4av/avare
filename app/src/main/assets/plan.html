<!DOCTYPE html>
<html lang="en">
<!--
Copyright (c) 2015, Apps4Av Inc. (apps4av.com)
All rights reserved.

Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

    * Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
    *     * Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.
    *
    *     THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

authors: zkhan
-->

<head>

    <!-- Latest compiled and minified CSS -->
    <script src="file:///android_asset/jquery.min.js"></script>
    <script src="file:///android_asset/bootstrap.min.js"></script>
    <script src="file:///android_asset/bootstrap-select.min.js"></script>
    <script src="file:///android_asset/bootbox.min.js"></script>
    <script src="file:///android_asset/toastr.min.js"></script>
    <link rel="stylesheet" href="file:///android_asset/bootstrap.min.css">
    <link rel="stylesheet" href="file:///android_asset/bootstrap-select.min.css">
    <link rel="stylesheet" href="file:///android_asset/toastr.min.css">
    <style type="text/css">
        button {color: black; height:40px;}
        input {height:40px; border-radius: 5px;}
        .toast {opacity: 1 !important;}
        .modal {
          margin-top: 50px;
          margin-bottom: 50px;
          margin-right: 10px;
          margin-left: 10px;
         }
    </style>

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script type="text/javascript" >

	toastr.options.timeOut = 2000;

// set the table for faa plans
//>Plan</th><th>State</th><th>Activate</th><th>Cancel</th><th>Close<
var CELL_FAA_NAME = 0;
var CELL_FAA_STATE = 1;
var CELL_FAA_LAST = 2;
function set_faa_plans(plan) {
	var plans = plan.split(",");

	// delete the table
	var faa_plan_save = document.getElementById("save_table_faa");
	for(var row = faa_plan_save.rows.length - 1; row >= 1; row--) {
			faa_plan_save.deleteRow(row);
	}

	// add all rows
	var count = 0;
	for(var r = 0; r < plans.length - 3; r += 3) {
		var row = faa_plan_save.insertRow(-1);
		var cell = [];

		// Insert new cells (<td> elements) at the positions of the "new" <tr> element:
		cell[CELL_FAA_NAME] = row.insertCell(CELL_FAA_NAME);
		cell[CELL_FAA_STATE] = row.insertCell(CELL_FAA_STATE);

		cell[CELL_FAA_NAME].textContent = plans[r + 1];
		cell[CELL_FAA_STATE].textContent = plans[r + 2];

		var next = plans[r];
		if(next == "1") {
			cell[CELL_FAA_NAME].style.backgroundColor = "green";
		}
		else {
			cell[CELL_FAA_NAME].style.backgroundColor = "black";
		}

		// set onclick on row
		row.onclick = (function() {
      	var currentI = count;
      	return function() {
         	onclick_row(currentI);
      	}
   	})();

   	count++;
	}
}

// This will move to a particular row on click
function onclick_row(row) {
	AndroidPlan.moveToFaa(row);
}

// Set email
function set_email(email) {
	document.getElementById("email_id").innerHTML = "<b>" + email + "<b>";
}


// fill a plan page from stored values
function plan_fill(
				aircraftId,
				flightRule,
				flightType,
				noOfAircraft,
				aircraftType,
				wakeTurbulence,
				aircraftEquipment,
				departure,
				departureDate,
				cruisingSpeed,
				level,
				surveillanceEquipment,
				route,
				otherInfo,
				destination,
				totalElapsedTime,
				alternate1,
				alternate2,
				fuelEndurance,
				peopleOnBoard,
				aircraftColor,
				supplementalRemarks,
				pilotInCommand,
				pilotInfo) {

				// non-ICAO destinations and departures need to be replaced with ZZZZ, and the
				// actual identifier moved to the Other Information field prefixed with either
				// DEP/ or DEST/
				if (departure.startsWith('K') && departure.search(/\d/) != -1) {
					if (otherInfo) { otherInfo += ' '; }
					otherInfo += 'DEP/' + departure.substring(1, 4);
					departure = 'ZZZZ';
				}
				if (destination.startsWith('K') && destination.search(/\d/) != -1) {
					if (otherInfo) { otherInfo += ' '; }
					otherInfo += 'DEST/' + destination.substring(1,4);
					destination = 'ZZZZ';
				}

				document.getElementById("icaoAircraftIdInput").value = aircraftId;

				var sel1 = document.getElementById("icaoFlightTypeSelection");
				for(var i = 0; i < sel1.length; i++) {
					if(flightType == sel1.options[i].value) {
						sel1.selectedIndex = i;
						 $('#icaoFlightTypeSelection').val(sel1.options[i].value).change();
						break;
					}
				}

				sel1 = document.getElementById("icaoFlightRuleSelection");
				for(var i = 0; i < sel1.length; i++) {
					if(flightRule == sel1.options[i].value) {
						sel1.selectedIndex = i;
						 $('#icaoFlightRuleSelection').val(sel1.options[i].value).change();
						break;
					}
				}
				document.getElementById("icaoNoOfAircraftInput").value = noOfAircraft;
				document.getElementById("icaoAircraftTypeInput").value = aircraftType;
				document.getElementById("icaoWakeTurbulenceSelection").value = wakeTurbulence;
				document.getElementById("icaoAircraftEquipmentInput").value = aircraftEquipment;
				document.getElementById("icaoDepartureInput").value = departure;
				document.getElementById("icaoDepartureDateInput").value = departureDate;
				document.getElementById("icaoCruisingSpeedInput").value = cruisingSpeed;
				document.getElementById("icaoLevelInput").value = level;
				document.getElementById("icaoSurveillanceEquipmentInput").value = surveillanceEquipment;
				document.getElementById("icaoRouteInput").value = route;
				document.getElementById("icaoOtherInfoInput").value = otherInfo;
				document.getElementById("icaoDestinationInput").value = destination;
				document.getElementById("icaoTotalEstimatedElapsedTimeInput").value = totalElapsedTime;
				document.getElementById("icaoAlternate1Input").value = alternate1;
				document.getElementById("icaoAlternate2Input").value = alternate2;
				document.getElementById("icaoFuelEnduranceInput").value = fuelEndurance;
				document.getElementById("icaoPeopleOnBoardInput").value = peopleOnBoard;
				document.getElementById("icaoAircraftColorInput").value = aircraftColor;
				document.getElementById("icaoSupplementalRemarksInput").value = supplementalRemarks;
				document.getElementById("icaoPilotInCommandInput").value = pilotInCommand;
				document.getElementById("icaoPilotInfoInput").value = pilotInfo;


}


// function to call plan_fill
function autofill() {

	bootbox.confirm("Do you want to discard all fields, and let the app fill new ones in the form?", function(result) {
		if(result == false) {
			return;
		}
		AndroidPlan.fillPlan();
		toastr.success('Filled from current Plan, and from Aircraft');
	});
}

// State change of plan like active
function plan_state_change(row, action) {
	bootbox.confirm("Do you want to " + action + " the plan?", function(result) {
		if(result == false) {
			return;
		}
		AndroidPlan.planChangeState(row, action);
	});
}


function activate_plan() {
	bootbox.confirm("You are about to activate a flight plan with the FAA. Are you sure you want to activate the selected plan?", function(result) {
		if(result == false) {
			return;
		}
		AndroidPlan.planChangeState("Activate", document.getElementById("activate_time").value);
	});
}

function close_plan() {
	bootbox.confirm("You are about to close a flight plan with the FAA. Are you sure you want to close the selected plan?", function(result) {
		if(result == false) {
			return;
		}
		AndroidPlan.planChangeState("Close", document.getElementById("close_location").value);
	});
}

function cancel_plan() {
	bootbox.confirm("You are about to cancel a flight plan with the FAA. Are you sure you want to cancel the selected plan?", function(result) {
		if(result == false) {
			return;
		}
		AndroidPlan.planChangeState("Cancel", "");
	});
}

// file a plan
function plan_file() {

	bootbox.confirm("You are about to file a flight plan with the FAA. Are you sure you want to file this plan?", function(result) {
		if(result == false) {
			return;
		}
		AndroidPlan.filePlan(
					document.getElementById("icaoAircraftIdInput").value,
					document.getElementById("icaoFlightRuleSelection").value,
					document.getElementById("icaoFlightTypeSelection").value,
					document.getElementById("icaoNoOfAircraftInput").value,
					document.getElementById("icaoAircraftTypeInput").value,
					document.getElementById("icaoWakeTurbulenceSelection").value,
					document.getElementById("icaoAircraftEquipmentInput").value,
					document.getElementById("icaoDepartureInput").value,
					document.getElementById("icaoDepartureDateInput").value,
					document.getElementById("icaoCruisingSpeedInput").value,
					document.getElementById("icaoLevelInput").value,
					document.getElementById("icaoSurveillanceEquipmentInput").value,
					document.getElementById("icaoRouteInput").value,
					document.getElementById("icaoOtherInfoInput").value,
					document.getElementById("icaoDestinationInput").value,
					document.getElementById("icaoTotalEstimatedElapsedTimeInput").value,
					document.getElementById("icaoAlternate1Input").value,
					document.getElementById("icaoAlternate2Input").value,
					document.getElementById("icaoFuelEnduranceInput").value,
					document.getElementById("icaoPeopleOnBoardInput").value,
					document.getElementById("icaoAircraftColorInput").value,
					document.getElementById("icaoSupplementalRemarksInput").value,
					document.getElementById("icaoPilotInCommandInput").value,
					document.getElementById("icaoPilotInfoInput").value
		);
	});

}

// fetch faa plans from internet
function get_faa_plans() {
	bootbox.confirm("Do you want to fetch or update your list of FAA filed plans from Internet?", function(result) {
		if(result == false) {
			return;
		}
		AndroidPlan.getPlans();
	});
}


function get_briefing() {
	bootbox.confirm("Get the briefing for the selected plan in email?", function(result) {
		if(result == false) {
			return;
		}
		AndroidPlan.getWeatherFaa();
	});
}


function load_plan() {
	bootbox.confirm("Load the selected plan in the form?", function(result) {
		if(result == false) {
			return;
		}
		AndroidPlan.loadPlan();
	});
}

function amend_plan() {
	bootbox.confirm("Amend the selected plan with information in the form?", function(result) {
		if(result == false) {
			return;
		}
			AndroidPlan.amendPlan(
				document.getElementById("icaoAircraftIdInput").value,
				document.getElementById("icaoFlightRuleSelection").value,
				document.getElementById("icaoFlightTypeSelection").value,
				document.getElementById("icaoNoOfAircraftInput").value,
				document.getElementById("icaoAircraftTypeInput").value,
				document.getElementById("icaoWakeTurbulenceSelection").value,
				document.getElementById("icaoAircraftEquipmentInput").value,
				document.getElementById("icaoDepartureInput").value,
				document.getElementById("icaoDepartureDateInput").value,
				document.getElementById("icaoCruisingSpeedInput").value,
				document.getElementById("icaoLevelInput").value,
				document.getElementById("icaoSurveillanceEquipmentInput").value,
				document.getElementById("icaoRouteInput").value,
				document.getElementById("icaoOtherInfoInput").value,
				document.getElementById("icaoDestinationInput").value,
				document.getElementById("icaoTotalEstimatedElapsedTimeInput").value,
				document.getElementById("icaoAlternate1Input").value,
				document.getElementById("icaoAlternate2Input").value,
				document.getElementById("icaoFuelEnduranceInput").value,
				document.getElementById("icaoPeopleOnBoardInput").value,
				document.getElementById("icaoAircraftColorInput").value,
				document.getElementById("icaoSupplementalRemarksInput").value,
				document.getElementById("icaoPilotInCommandInput").value,
				document.getElementById("icaoPilotInfoInput").value
    		);
	});
}


function setAircraftEquipment() {
	var codes = ["N", "S", "A", "B", "C", "D", "E1", "E2", "E3", "F", "G", "H", "I", "J1", "J2", "J3", "J4", "J5", "J6", "J7", "K", "L", "M1", "M2", "M3", "O", "R", "T", "U", "V", "W", "X", "Y", "Z"];
	var text = "";
	var reset = false;
    var arrayLength = codes.length;
    for (var i = 0; i < arrayLength; i++) {
        var id = document.getElementById("icaoAircraftEquipmentDialogCheckbox" + codes[i]);
	    if(id.checked) {
	        if(reset) {
	            id.checked = false;
	            continue;
	        }
	        text += id.value;
	    	if(codes[i] == "N") {
	    	    reset = true;
	    	}
	    }
    }
    var id = document.getElementById("icaoAircraftEquipmentInput");
    id.value = text;
}

function setAircraftSurveillance() {
	var codes = ["N", "A", "C", "E", "H", "I", "L", "P", "S", "X", "B1", "B2", "U1", "U2", "V1", "V2", "D1", "G1"];
	var text = "";
    var arrayLength = codes.length;
	var reset = false;
    for (var i = 0; i < arrayLength; i++) {
        var id = document.getElementById("icaoSurveillanceEquipmentDialogRadioButton" + codes[i]);
	    if(id.checked) {
	        if(reset) {
	            id.checked = false;
	            continue;
	        }
	        text += id.value;
	    	if(codes[i] == "N") {
	    	    reset = true;
	    	}
	    }
    }
    var id = document.getElementById("icaoSurveillanceEquipmentInput");
    id.value = text;
}

$(document).ready(function(){
    $(".nav-tabs a").click(function(){
        $(this).tab('show');
    });
});

function zeroPad(num) {
	var out = num.toString();
	if(out.length == 2) {
		return out;
	}
	else {
		return '0' + out;
	}
}

function refresh() {
	location.reload(true);
}

function getImageWinds(type, level, ftime) {
	var elem = document.getElementById('weatherImageWinds');
	if     (level == '030') level = '900';
	else if(level == '060') level = '800';
	else if(level == '090') level = '725';
	else if(level == '120') level = '650';
	else if(level == '150') level = '575';
	else if(level == '180') level = '500';
	else if(level == '240') level = '400';
	else if(level == '300') level = '300';
	else if(level == '360') level = '225';
	else if(level == '420') level = '175';
	else if(level == '480') level = '125';

	var filename = 'https://aviationweather.gov/data/products/wind/' + ftime + '_' + level + '_' + type + '.gif';
	elem.src = filename;
}

function updateImageWinds() {
	var telem = document.getElementById('type');
	var type = telem.options[telem.selectedIndex].value;
	var lelem = document.getElementById('level');
	var level = lelem.options[lelem.selectedIndex].value;
	var felem = document.getElementById('fore');
	var ftime = felem.options[felem.selectedIndex].value;
	getImageWinds(type, level, ftime);
}

function getImageTurb(level, ftime) {
	var elem = document.getElementById('weatherImageTurb');
	var filename = 'https://aviationweather.gov/data/products/turbulence/F' + ftime + '_gtg_' + level + '_total.gif';
	elem.src = filename;
}

function updateImageTurb() {
	var lelem = document.getElementById('levelTurb');
	var level = lelem.options[lelem.selectedIndex].value;
	var felem = document.getElementById('foreTurb');
	var fore = felem.options[felem.selectedIndex].value;
	getImageTurb(level, fore);
}

function getImageIcing(type, level, ftime) {
	var elem = document.getElementById('weatherImageIcing');
	var prod = '';
	if (type == 'frz') {
	    prod = '_rap_frz_hght';
	}
	else {
	    prod = (ftime == '00' ? '_cip_' : '_fip_') + level + '_' + type;
	}

	var filename = 'https://aviationweather.gov/data/products/icing/F' + ftime + prod + '.gif';
	elem.src = filename;
}

function updateImageIcing() {
	var lelem = document.getElementById('levelIce');
	var level = lelem.options[lelem.selectedIndex].value;
	var felem = document.getElementById('foreIce');
	var fore = felem.options[felem.selectedIndex].value;
	var telem = document.getElementById('typeIce');
	var type = telem.options[telem.selectedIndex].value;
	getImageIcing(type, level, fore);
}

function getImageMisc(type) {
	var elem = document.getElementById('weatherImageMisc');
	elem.src = type;
}

function updateImageMisc() {
	var melem = document.getElementById('typeMisc');
	var misc = melem.options[melem.selectedIndex].value;
	getImageMisc(misc);
}

function getImageProg(type) {
	var elem = document.getElementById('weatherImageProg');
	elem.src = type;
}

function updateImageProg() {
	var elem = document.getElementById('typeProg');
	var prog = elem.options[elem.selectedIndex].value;
	getImageProg(prog);
}

function settext() {
	var txt = document.getElementById('timetxt');
	var now = new Date();
	var utc =  (now.getUTCMonth()) + 1 + '/' + now.getUTCDate() + ' ' + zeroPad(now.getUTCHours()) + '' + zeroPad(now.getUTCMinutes()) + ' UTC';

	txt.value = utc;
	getData();

}

function getData() {
	AndroidPlan.getWeatherFaa();
}

function updateData(weather) {
	var table = document.getElementById('plantable');
	table.innerHTML = weather;
}

window.onload = settext;

$(document).ready(function(){
    $(".nav-tabs a").click(function(){
        $(this).tab('show');
    });
    updateImageMisc();
    updateImageProg();
    updateImageWinds();
    updateImageTurb();
    updateImageIcing();
});

	toastr.options.timeOut = 2000;

var CELL_WP = 0;
var CELL_TYPE = 1;
var CELL_COURSE = 2;
var CELL_WINDT = 3;
var CELL_HEADING = 4;
var CELL_DISTANCE = 5;
var CELL_GS = 6;
var CELL_ALTITUDE = 7;
var CELL_TIME = 8;
var CELL_FUEL = 9;
var CELL_LAST = 10;

var plan_poll_timer = setInterval(function () {loadplan()}, 1000);

// load plan from Android then display every second
function loadplan() {
	var str = AndroidPlan.getPlanData();
	// split plan data encoded in ::
	var plans = str.split("::::");
	plan_setname(plans[0]);
	for(var pl = 1; pl < (plans.length - 1); pl++) {
		// split plan individual fields
		var data = plans[pl].split(",");
		if(!set_plan_line(pl, data[0], data[1], data[2], data[3], data[4], data[5], data[6], data[7], data[8], data[9], data[10])) {
			// mismatch in view and model, sync
			AndroidPlan.refreshPlan();
			return;
		}
	}

	// delete extra lines in plan table
	// XXX: ZIMMZ Q42 MIKYG Q480 AIR APE KDAY not working properly
	var plan_table = document.getElementById("plan_table");
    for(var row = plan_table.rows.length - 1; row > plans.length; row--) {
        plan_table.deleteRow(row);
    }

	plan_set_total(plans[plans.length - 1]);
}

// set plan name
function plan_setname(name) {
	var plan = document.getElementById("plan_name");

	plan.textContent = "Plan" + "[" + name + "]";
}

// set weather
function update_weather(weather) {
    updateData(weather);
}


// This will move to a particular row on click
function onclick_row(row) {
	AndroidPlan.moveTo(row - 1);
}

function set_plan_line(row, next, course, heading, distance, gs, time, id, type, fuel, windt, alt) {
	// rows here are 1 indexed
// Set plan line
	var plan_table = document.getElementById("plan_table");
	// do not overwrite array
	if(row >= plan_table.rows.length) {
		return false;
	}

	if(next == "1") {
		plan_table.rows[row].cells[CELL_WP].style.backgroundColor = "#71bc78";
	}
	else {
		plan_table.rows[row].cells[CELL_WP].style.backgroundColor = "black";
	}

	plan_table.rows[row].cells[CELL_WP].textContent = id.substr(0, 20);
	if(id.length > 12) {
		plan_table.rows[row].cells[CELL_WP].style.fontSize = 6;
	}
	else if(id.length > 6) {
		plan_table.rows[row].cells[CELL_WP].style.fontSize = 12;
	}
	else {
		plan_table.rows[row].cells[CELL_WP].style.fontSize = 24;
	}

	plan_table.rows[row].cells[CELL_TYPE].textContent = type;

	plan_table.rows[row].cells[CELL_COURSE].textContent = course;
	plan_table.rows[row].cells[CELL_WINDT].textContent = windt;
	plan_table.rows[row].cells[CELL_GS].textContent = gs;
	plan_table.rows[row].cells[CELL_ALTITUDE].textContent = alt;
	plan_table.rows[row].cells[CELL_DISTANCE].textContent = distance;
	plan_table.rows[row].cells[CELL_TIME].textContent = time;
	plan_table.rows[row].cells[CELL_HEADING].textContent = heading;
	plan_table.rows[row].cells[CELL_FUEL].textContent = fuel;

	plan_table.rows[row].onclick = (function() {
      var currentI = row;
      return function() {
          onclick_row(currentI);
      }
   })();

   return true;
}

// add a way point to the plan
function plan_add(id, type) {
	var plan_table = document.getElementById("plan_table");
	var search_table = document.getElementById("search_table");

	// clear the search table
	for(var row = search_table.rows.length - 1; row >= 1; row--) {
			search_table.deleteRow(row);
	}

	var row = plan_table.insertRow(-1);

	var cell = [];

	// Insert new cells (<td> elements) at the 1st and 2nd position of the "new" <tr> element:
	cell[CELL_WP] = row.insertCell(CELL_WP);
	cell[CELL_TYPE] = row.insertCell(CELL_TYPE);
	cell[CELL_COURSE] = row.insertCell(CELL_COURSE);
	cell[CELL_WINDT] = row.insertCell(CELL_WINDT);
	cell[CELL_HEADING] = row.insertCell(CELL_HEADING);
	cell[CELL_DISTANCE] = row.insertCell(CELL_DISTANCE);
	cell[CELL_GS] = row.insertCell(CELL_GS);
	cell[CELL_ALTITUDE] = row.insertCell(CELL_ALTITUDE);
	cell[CELL_TIME] = row.insertCell(CELL_TIME);
	cell[CELL_FUEL] = row.insertCell(CELL_FUEL);

	cell[CELL_WP].textContent = id.substring(0, 6);
	cell[CELL_TYPE].textContent = type;
	cell[CELL_WINDT].textContent = "";
	cell[CELL_GS].textContent = "";
	cell[CELL_ALTITUDE].textContent = "";
	cell[CELL_DISTANCE].textContent = "";
	cell[CELL_TIME].textContent = "";
	cell[CELL_COURSE].textContent = "";
	cell[CELL_HEADING].textContent = "";
	cell[CELL_FUEL].textContent = "";

    // clear search input
    document.getElementById("search_input").value = "";

    //each time plan updates, update "create new plan" for faster plan editing
    document.getElementById("create_input").value += id.substring(0, 6) + " ";
}

// Delete a waypoint in Plan
function plan_delete() {
    var msgStr = "Delete waypoint \"" + AndroidPlan.nextWaypointID() + "\"?";
	bootbox.confirm(msgStr, function(result) {
		if(result == false) {
			return;
		}
    	AndroidPlan.deleteWaypoint();
	});
}

// Move up in the list a waypoint
function plan_moveup() {
	AndroidPlan.moveUp();
}

// Move down in the list a waypoint
function plan_movedn() {
	AndroidPlan.moveDown();
}


// Set Plan totals
function plan_set_total(total) {
	// plan total is split to show individual values
	var vals = total.replace(/^[ ]+|[ ]+$/g,'').split(" ");
	document.getElementById("plan_total_distance").innerHTML = "Distance<br><font color='#71bc78'>" + vals[0] + "</font>";
	document.getElementById("plan_total_time").innerHTML = "Time<br><font color='#71bc78'>" + vals[1] + "</font>";
	// total bearing makes no sense
	document.getElementById("plan_total_fuel").innerHTML = "Fuel<br><font color='#71bc78'>" + vals[3] + "</font>";
}

// clear the entire plan
function plan_clear() {
	// clear the table
	var plan_table = document.getElementById("plan_table");
	for(var row = plan_table.rows.length - 1; row >= 1; row--) {
			plan_table.deleteRow(row);
	}
    document.getElementById('plan_altitude').selectedIndex = 0;

    //clear Create New Plan box as well
    document.getElementById("create_input").value = "";
}

// remove the entire plan
function plan_discard() {
	// calll Android
	bootbox.confirm("Delete Plan?", function(result) {
		if(result == false) {
			return;
		}
		AndroidPlan.discardPlan();
	});
}

// create the plan
function plan_create() {

	var name = document.getElementById("create_input").value.trim();

	if(name == "") {
		toastr.error('Please enter a valid route');
		return;
	}

    AndroidPlan.discardPlan();
    AndroidPlan.createPlan(name);

    $('[href="#plan"]').tab('show');

}

var CELL_SAVE_NAME = 0;
var CELL_SAVE_LOAD = 1;
var CELL_SAVE_LOAD_REV = 2;
var CELL_SAVE_DELETE = 3;
var CELL_SAVE_LAST = 4;

// load the plan
function save_load(row) {
	var plan_save = document.getElementById("save_table");
	AndroidPlan.loadPlan(plan_save.rows[row].cells[CELL_SAVE_NAME].textContent);
	document.getElementById("plan_name").scrollIntoView();
	$('[href="#plan"]').tab('show');
}

// load the plan reverse
function save_load_reverse(row) {
	var plan_save = document.getElementById("save_table");
	AndroidPlan.loadPlanReverse(plan_save.rows[row].cells[CELL_SAVE_NAME].textContent);
	document.getElementById("plan_name").scrollIntoView();
	$('[href="#plan"]').tab('show');
}

// delete the plan
function save_delete(row) {
	var plan_save = document.getElementById("save_table");
	var plan_name = plan_save.rows[row].cells[CELL_SAVE_NAME].textContent;
	var prompt_text = "Delete \"";
	var prompt = prompt_text.concat(plan_name, "\" ?");

	bootbox.confirm(prompt, function(result) {
		if(result == false) {
			return;
		}
    	AndroidPlan.saveDelete(plan_name);
		toastr.success('Plan deleted');

	});

}

// add the current plan to saved list
function save_plan_add() {
	var name = document.getElementById("save_name").value;

	if(name == "") {
		toastr.error('Please specify a valid name');
		return;
	}
	AndroidPlan.savePlan(name);
	toastr.success('Plan saved to ' + name);

}

// clear the entire save plan
function save_clear() {
	// clear the table
	var plan_save = document.getElementById("save_table");
	for(var row = plan_save.rows.length - 1; row >= 1; row--) {
			plan_save.deleteRow(row);
	}
}

// Plan table can be long. Hide it when asked or toggle it to show/hide
function save_hide(toggle) {
	var plan_save = document.getElementById("save_table");
	for(var row = plan_save.rows.length - 1; row >= 1; row--) {
			if(toggle) {
				if(plan_save.rows[row].style.display == "none") {
					plan_save.rows[row].style.display = "";
				}
				else {
					plan_save.rows[row].style.display = "none";
				}
			}
			else {
					plan_save.rows[row].style.display = "none";
			}
	}
}

function plan_filter() {
	var plan_filter = document.getElementById("plan_filter").value;
	AndroidPlan.planFilter(plan_filter);
}

// Sets buttons on each row
function set_buttons_save() {

	// Set buttons for each entry in plan
	var plan_save = document.getElementById("save_table");
	for(var i = 1; i < plan_save.rows.length; i++) {
		plan_save.rows[i].cells[CELL_SAVE_LOAD].innerHTML =
			"<button class='btn btn-block' onclick='save_load(" + i.toString() + ")'>LD</button>";
		plan_save.rows[i].cells[CELL_SAVE_LOAD_REV].innerHTML =
			"<button class='btn btn-block' onclick='save_load_reverse(" + i.toString() + ")'>LR</button>";
		plan_save.rows[i].cells[CELL_SAVE_DELETE].innerHTML =
			"<button class='btn btn-block' onclick='save_delete(" + i.toString() + ")'>Del</button>";
	}

		// clear save input
	document.getElementById("save_name").value = "";
}

// add a way point to the plan
function save_add(name) {
	var plan_save = document.getElementById("save_table");

	var row = plan_save.insertRow(-1);

	var cell = [];

	// Insert new cells (<td> elements) at the 1st and 2nd position of the "new" <tr> element:
	cell[CELL_SAVE_NAME] = row.insertCell(CELL_SAVE_NAME);
	cell[CELL_SAVE_LOAD] = row.insertCell(CELL_SAVE_LOAD);
	cell[CELL_SAVE_LOAD_REV] = row.insertCell(CELL_SAVE_LOAD_REV);
	cell[CELL_SAVE_DELETE] = row.insertCell(CELL_SAVE_DELETE);

	cell[CELL_SAVE_NAME].textContent = name;
	cell[CELL_SAVE_LOAD].style.textAlign="center";
	cell[CELL_SAVE_LOAD_REV].style.textAlign="center";
	cell[CELL_SAVE_DELETE].style.textAlign="center";

	set_buttons_save();

	save_hide(false);
}

var CELL_SEARCH_WP = 0;
var CELL_SEARCH_ACTION = 1;
var CELL_SEARCH_NAME = 2;
var CELL_SEARCH_TYPE = 3;
var CELL_SEARCH_LAST = 4;


// Search a waypoint specified
function search_waypoint() {

	// search from input
	var id = document.getElementById("search_input").value.trim();
	var search_table = document.getElementById("search_table");

	if(id == "") {
		return;
	}

	// clear the table
	for(var row = search_table.rows.length - 1; row >= 1; row--) {
			search_table.deleteRow(row);
	}

	// search
	AndroidPlan.search(id);
}

function plan_add_search(id, type, subtype) {
	// now call Android for result of add

	AndroidPlan.addToPlan(id, type, subtype);
	toastr.success(id + ' added to plan');
}

// Add the result of a search to search table
function search_add(id, name, type, subtype) {

	var search_table = document.getElementById("search_table");

	var row = search_table.insertRow(-1);

	var cell = [];

	// Insert new cells (<td> elements) at the 1st and 2nd position of the "new" <tr> element:
	cell[CELL_SEARCH_WP] = row.insertCell(CELL_SEARCH_WP);
	cell[CELL_SEARCH_ACTION] = row.insertCell(CELL_SEARCH_ACTION);
	cell[CELL_SEARCH_NAME] = row.insertCell(CELL_SEARCH_NAME);
	cell[CELL_SEARCH_TYPE] = row.insertCell(CELL_SEARCH_TYPE);

	cell[CELL_SEARCH_WP].textContent = id;
	// this button will add to plan a particular result from search
	cell[CELL_SEARCH_ACTION].innerHTML = "<button class='btn btn-block' onclick='plan_add_search(" + "\"" + id + "\",\"" + type + "\",\"" + subtype + "\")'>Add</button>";
	cell[CELL_SEARCH_NAME].textContent = name;
	cell[CELL_SEARCH_TYPE].textContent = type + "-" + subtype;
}

function plan_get_weather() {
	bootbox.confirm("Get Latest Plan Briefing from Internet?", function(result) {
		if(result == false) {
			return;
		}
    	AndroidPlan.getWeather();
	});
}

function plan_set_altitude() {
    var elt = document.getElementById('plan_altitude');
    AndroidPlan.setAltitude(elt.options[elt.selectedIndex].text);
}

function next() {
	AndroidPlan.nextPage();
}

function last() {
	AndroidPlan.lastPage();
}

function disable_next(flag) {
	var listNext = document.getElementById("list_next");
	listNext.disabled = flag;
}

function first() {
	AndroidPlan.firstPage();
}

function prev() {
	AndroidPlan.prevPage();
}

function disable_prev(flag) {
	var listPrev = document.getElementById("list_prev");
	listPrev.disabled = flag;
}

function set_plan_count(planCount) {
	var plan_count = document.getElementById("plan_count");
	plan_count.textContent = planCount;
}

function refresh_plan_list() {
	AndroidPlan.refreshPlanList();
}

$(document).ready(function(){
    $(".nav-tabs a").click(function(){
        $(this).tab('show');
    });
});


</script>

</head>
<body>

<ul class="nav nav-tabs" style="display:inline-flex;">
    <li class="active"><a href="#plan">Plan</a></li>
    <li><a href="#load">Load</a></li>
    <li><a href="#save">Save</a></li>
    <li><a href="#new">New</a></li>
    <li><a href="#filing">Filing</a></li>
    <li><a href="#brief">Brief</a></li>
    <li><a href="#help">Help</a></li>
</ul>

<div class="tab-content">

    <div id="plan" class="tab-pane fade in active">
        <table class="table">
            <tr>
                <td><h3 ><span class="label label-success" id="plan_name">Plan[]</span></h3> </td>
            </tr>
            <tr>
                <td>@<select id="plan_altitude" onchange="plan_set_altitude()" data-mobile="true" class="selectpicker">
                    <option>000</option>
                    <option>030</option>
                    <option>035</option>
                    <option>040</option>
                    <option>045</option>
                    <option>050</option>
                    <option>055</option>
                    <option>060</option>
                    <option>065</option>
                    <option>070</option>
                    <option>075</option>
                    <option>080</option>
                    <option>085</option>
                    <option>090</option>
                    <option>095</option>
                    <option>100</option>
                    <option>105</option>
                    <option>110</option>
                    <option>115</option>
                    <option>120</option>
                    <option>125</option>
                    <option>130</option>
                    <option>135</option>
                    <option>140</option>
                    <option>145</option>
                    <option>150</option>
                    <option>155</option>
                    <option>160</option>
                    <option>165</option>
                    <option>170</option>
                    <option>175</option>
                    <option>180</option>
                    <option>190</option>
                    <option>200</option>
                    <option>210</option>
                    <option>220</option>
                    <option>230</option>
                    <option>240</option>
                    <option>250</option>
                    <option>260</option>
                    <option>270</option>
                    <option>280</option>
                    <option>290</option>
                    <option>300</option>
                    <option>310</option>
                    <option>320</option>
                    <option>330</option>
                    <option>340</option>
                    <option>350</option>
                    <option>360</option>
                    <option>370</option>
                    <option>380</option>
                    <option>390</option>
                </select>x100ft / FL
                </td>
            </tr>
        </table>
        <table class="table" id="plan_table"><th>Waypoint</th><th>Type</th><th>Course</th><th>Wind</th><th>Heading</th><th id="plan_total_distance">Distance</th><th>GS</th><th>Altitude</th><th id="plan_total_time">Time</th><th id="plan_total_fuel">Fuel</th></table>
        <table class="table">
            <tr>
                <td><button class="btn btn-block" onclick="plan_discard()">Clr</button></td>
                <td><button class="btn btn-block" onclick="plan_delete()">Del</button></td>
                <td><button class="btn btn-block" onclick="plan_moveup()">Up</button></td>
                <td><button class="btn btn-block" onclick="plan_movedn()">Dn</button></td>
            </tr>
        </table>

        <table class="table"><th>Add Waypoint to Plan</th>
            <tr>
                <td><input id="search_input" style="text-transform:uppercase" spellcheck="false" placeholder="BOS"></td>
                <td><button class="btn btn-block" onclick="search_waypoint()">Search</button></td>
            </tr>
        </table>
        <table class="table" id="search_table"><th>Waypoint</th><th>Action</th><th>Name</th><th>Type</th></table>


    </div>

    <div id="new" class="tab-pane fade">

        <table class="table"><th>Create New Plan</th>
            <tr>
                <td><input id="create_input" style="text-transform:uppercase" spellcheck="false" placeholder="KBOS BOS V1 HFD KHFD"></td>
                <td><button class="btn btn-block" onclick="plan_create()">Create</button></td>
            </tr>
        </table>

    </div>

    <div id="load" class="tab-pane fade">
        <table class="table"><th>Load a Plan</th>
        </table>
        <table class="table" id="save_table"><th>Plan</th><th></th><th></th><th></th></table>
        <table class="table">
            <tr>
                <td id="plan_count"></td>
            </tr>
            <tr>
                <td><button class="btn btn-block" id="list_first" onclick="first()">&lt;&lt;</button></td>
                <td><button class="btn btn-block" id="list_prev" onclick="prev()">&lt;</button></td>
                <td><button class="btn btn-block" id="list_next" onclick="next()">&gt;</button></td>
                <td><button class="btn btn-block" id="list_last" onclick="last()">&gt;&gt;</button></td>
            </tr>
        </table>
        <table class="table">
            <th>Filter Saved Plans</th>
        </table>
        <table class="table">
            <tr>
                <td><input id="plan_filter" spellcheck="false" placeholder="Plan Filter Spec."></td>
                <td><button class="btn btn-block" onclick="plan_filter()">Apply</button></td>
            </tr>
        </table>
        <table class="table">
            <tr>
                <td><button class="btn btn-block" onclick="refresh_plan_list()">Refresh List</button></td>
            </tr>
        </table>
    </div>

    <div id="save" class="tab-pane fade">
        <table class="table"><th>Save Current Plan</th>
            <tr>
                <td><input id="save_name" spellcheck="false" placeholder="Current Plan Name"></td>
                <td><button class="btn btn-block" onclick="save_plan_add()">Save</button></td>
            </tr>
        </table>
    </div>

    <div id="filing" class="tab-pane fade">
        <ul class="nav nav-tabs" style="display:inline-flex;">
            <li class="active"><a href="#file">File</a></li>
            <li><a href="#filedplans">Filed Plans</a></li>
        </ul>

        <div class="tab-content">
            <div id="file" class="tab-pane fade in active">
                <table class="table"><th>File an ICAO Plan</th>
                    <tr>
                        <td><button class="btn btn-block" onclick="autofill()">Prepare</button></td><td>Press to fill this form using Plan and Aircraft</td>
                    </tr>
                    <tr>
                        <td>Aircraft ID</td><td><input spellcheck="false" style="text-transform:uppercase" id="icaoAircraftIdInput"/></td>
                    </tr>
                    <tr>
                        <td>Flight Rule</td><td><select class="selectpicker" data-mobile="true"  id="icaoFlightRuleSelection"><option>VFR</option><option>IFR</option><option>YFR</option><option>ZFR</option></select></td>
                    </tr>
                    <tr>
                        <td>Flight Type</td><td><select class="selectpicker" data-mobile="true"  id="icaoFlightTypeSelection"><option value="S">Scheduled</option><option value="N">Non Scheduled</option><option value="G">General Aviation</option><option value="M">Military</option><option value="X">Other</option></select></td>
                    </tr>
                    <tr>
                        <td>No. of Aircraft</td><td><input id="icaoNoOfAircraftInput"/></td>
                    </tr>
                    <tr>
                        <td>Aircraft Type</td><td><input spellcheck="false" style="text-transform:uppercase" id="icaoAircraftTypeInput"/></td>
                    </tr>
                    <tr>
                        <td>Wake Turbulence</td><td><input  id="icaoWakeTurbulenceSelection"/></td>
                    </tr>
                    <tr>
                        <td>Aircraft Equipment</td><td><input spellcheck="false" style="text-transform:uppercase" id="icaoAircraftEquipmentInput" ></td>
                    </tr>
                    <tr>
                        <td>Departure</td><td><input spellcheck="false" style="text-transform:uppercase" id="icaoDepartureInput"/></td>
                    </tr>
                    <tr>
                        <td>Departure Date&Time</td><td><input spellcheck="false" style="text-transform:uppercase" id="icaoDepartureDateInput"/></td>
                    </tr>
                    <tr>
                        <td>Cruising Speed</td><td><input id="icaoCruisingSpeedInput"/></td>
                    </tr>
                    <tr>
                        <td>Altitude</td><td><input id="icaoLevelInput"/></td>
                    </tr>
                    <tr>
                        <td>Surveillance Equipment</td><td><input spellcheck="false" style="text-transform:uppercase" id="icaoSurveillanceEquipmentInput" /></td>
                    </tr>
                    <tr>
                        <td>Route</td><td><input spellcheck="false" style="text-transform:uppercase" id="icaoRouteInput"/></td>
                    </tr>
                    <tr>
                        <td>Other Info</td><td><input spellcheck="false" id="icaoOtherInfoInput"/></td>
                    </tr>
                    <tr>
                        <td>Destination</td><td><input spellcheck="false" style="text-transform:uppercase" id="icaoDestinationInput"/></td>
                    </tr>
                    <tr>
                        <td>Total Elapsed Time</td><td><input spellcheck="false" style="text-transform:uppercase" id="icaoTotalEstimatedElapsedTimeInput"/></td>
                    </tr>
                    <tr>
                        <td>Alternate 1</td><td><input spellcheck="false" style="text-transform:uppercase" id="icaoAlternate1Input"/></td>
                    </tr>
                    <tr>
                        <td>Alternate 2</td><td><input spellcheck="false" style="text-transform:uppercase" id="icaoAlternate2Input"/></td>
                    </tr>
                    <tr>
                        <td>Fuel Endurance</td><td><input spellcheck="false" style="text-transform:uppercase" id="icaoFuelEnduranceInput"/></td>
                    </tr>
                    <tr>
                        <td>People On Board</td><td><input id="icaoPeopleOnBoardInput"/></td>
                    </tr>
                    <tr>
                        <td>Aircraft Color</td><td><input spellcheck="false" style="text-transform:uppercase" id="icaoAircraftColorInput"/></td>
                    </tr>
                    <tr>
                        <td>Supplemental Remarks</td><td><input spellcheck="false" id="icaoSupplementalRemarksInput"/></td>
                    </tr>
                    <tr>
                        <td>Pilot In Command</td><td><input spellcheck="false" id="icaoPilotInCommandInput"/></td>
                    </tr>
                    <tr>
                        <td>Pilot Info</td><td><input spellcheck="false" id="icaoPilotInfoInput"/></td>
                    </tr>
                    <tr>
                        <td><button class="btn btn-block" onclick="plan_file()">File Plan</button></td><td>Press to file this form as <label id="email_id"></label></td>
                    </tr>
                </table>

            </div>

            <div id="filedplans" class="tab-pane fade">
                <table class="table"><th>Filed Plans</th></table>
                <table id="save_table_faa" class="table">
                    <th>Plan</th><th>State</th>
                </table>
                <table class="table">
                    <tr>
                        <td><button class="btn btn-block" onclick="get_faa_plans()">Get Plans</button></td><td>Get filed plans from internet</td>
                    </tr>
                    <tr>
                        <td><button class="btn btn-block" onclick="load_plan()">Load</button></td><td>Load selected plan to File form</td>
                    </tr>
                    <tr>
                        <td><button class="btn btn-block" onclick="amend_plan()">Amend</button></td><td>Amend selected plan from the File form</td>
                    </tr>
                    <tr>
                        <td><button class="btn btn-block" onclick="cancel_plan()">Cancel</button></td><td>Cancel selected plan</td>
                    </tr>
                    <tr>
                        <td><button class="btn btn-block" onclick="activate_plan()">Activate</button></td>
                        <td><select class="selectpicker" data-mobile="true" id="activate_time">
                            <option value="0">Departing Now</option>
                            <option value="5">Departing 5 minutes from now</option>
                            <option value="10">Departing 10 minutes from now</option>
                            <option value="15">Departing 15 minutes from now</option>
                            <option value="20">Departing 20 minutes from now</option>
                            <option value="25">Departing 25 minutes from now</option>
                            <option value="30">Departing 30 minutes from now</option>
                        </select>
                        </td>
                    </tr>
                    <tr>
                        <td><button class="btn btn-block" onclick="get_briefing()">Get Email Briefing</button></td><td>Get briefing in email for selected plan</td>
                    </tr>
                    <tr>
                        <td><button class="btn btn-block" onclick="close_plan()">Close</button></td>
                        <td><input id="close_location" spellcheck="false" style="text-transform:uppercase" placeholder="e.g. KBOS" /></td>
                    </tr>
                </table>
            </div>

        </div>

    </div>

    <div id="brief" class="tab-pane fade">
        <ul class="nav nav-tabs" style="display:inline-flex;">
            <li class="active"><a href="#textual">Textual</a></li>
            <li><a href="#misc">Misc</a></li>
            <li><a href="#prog">Prog</a></li>
            <li><a href="#windstemp">Winds/Temp</a></li>
            <li><a href="#turb">Turb</a></li>
            <li><a href="#icing">Icing</a></li>
        </ul>


        <div class="tab-content">
            <div id="misc" class="tab-pane fade">
                <h3>Misc. Charts</h3>
                <select class="selectpicker" id='typeMisc' data-mobile="true"  name='typeMisc' onChange='updateImageMisc()'>
                    <option value='https://aviationweather.gov/data/obs/pirep/pireps_turb_us.gif'>PIREPs Turbulence</option>
                    <option value='https://aviationweather.gov/data/obs/pirep/pireps_ice_us.gif'>PIREPs Icing</option>
                    <option value='https://aviationweather.gov/data/obs/pirep/pireps_wx_us.gif'>PIREPs Weather</option>
                    <option value='https://aviationweather.gov/data/products/gairmet/F00_gairmet_sierra_us.gif'>AIRMET Sierra</option>
                    <option value='https://aviationweather.gov/data/products/gairmet/F00_gairmet_tango_us.gif'>AIRMET Tango</option>
                    <option value='https://aviationweather.gov/data/products/gairmet/F00_gairmet_zulu-f_us.gif'>AIRMET Zulu</option>
                    <option value='https://aviationweather.gov/data/products/sigmet/sigmet_all.gif'>SIGMETs</option>
                    <option value='https://aviationweather.gov/data/obs/metar/metars_us.gif'>METAR</option>
                    <option value='https://aviationweather.gov/data/obs/radar/rcm_tops.gif'>Radar</option>
                    <option value='https://aviationweather.gov/data/obs/sat/us/sat_vis_us.jpg'>Satellite</option>
                    <option value='http://www.ospo.noaa.gov/data/land/fire/currenthms.jpg'>Fire and Smoke</option>
                </select>
                <br><img id='weatherImageMisc'><br>
            </div>
            <div id="prog" class="tab-pane fade">
                <h3>Prognostic Charts</h3>
                <select class="selectpicker" id='typeProg' data-mobile="true" name='typeProg' onChange='updateImageProg()'>
                    <option value='https://aviationweather.gov/data/products/progs/F000_wpc_sfc.gif'>WPC Surface Analysis</option>
                    <option value='https://aviationweather.gov/data/products/progs/F006_wpc_prog.gif'>WPC 6 HR Prognostic</option>
                    <option value='https://aviationweather.gov/data/products/progs/F012_wpc_prog.gif'>WPC 12 HR Prognostic</option>
                    <option value='https://aviationweather.gov/data/products/progs/F018_wpc_prog.gif'>WPC 18 HR Prognostic</option>
                    <option value='https://aviationweather.gov/data/products/progs/F024_wpc_prog.gif'>WPC 24 HR Prognostic</option>
                    <option value='https://aviationweather.gov/data/products/progs/F030_wpc_prog.gif'>WPC 30 HR Prognostic</option>
                    <option value='https://aviationweather.gov/data/products/progs/F036_wpc_prog.gif'>WPC 36 HR Prognostic</option>
                    <option value='https://aviationweather.gov/data/products/progs/F048_wpc_prog.gif'>WPC 48 HR Prognostic</option>
                    <option value='https://aviationweather.gov/data/products/progs/F060_wpc_prog.gif'>WPC 60 HR Prognostic</option>
                    <option value='https://aviationweather.gov/data/products/progs/F072_wpc_prog.gif'>WPC 72 HR Prognostic</option>
                    <option value='https://aviationweather.gov/data/products/progs/F096_wpc_prog.gif'>WPC 96 HR Prognostic</option>
                    <option value='https://aviationweather.gov/data/products/progs/F120_wpc_prog.gif'>WPC 120 HR Prognostic</option>
                    <option value='https://aviationweather.gov/data/products/progs/F144_wpc_prog.gif'>WPC 144 HR Prognostic</option>
                    <option value='https://aviationweather.gov/data/products/progs/F168_wpc_prog.gif'>WPC 168 HR Prognostic</option>
                    <option value='https://aviationweather.gov/data/products/swl/00_sigwx_lo_us.gif'>Low Level Significant 0000Z</option>
                    <option value='https://aviationweather.gov/data/products/swl/06_sigwx_lo_us.gif'>Low Level Significant 0600Z</option>
                    <option value='https://aviationweather.gov/data/products/swl/12_sigwx_lo_us.gif'>Low Level Significant 1200Z</option>
                    <option value='https://aviationweather.gov/data/products/swl/18_sigwx_lo_us.gif'>Low Level Significant 1800Z</option>
                    <option value='https://aviationweather.gov/data/products/swm/00_sigwx_mid_nat.gif'>Mid Level Significant 0000Z</option>
                    <option value='https://aviationweather.gov/data/products/swm/06_sigwx_mid_nat.gif'>Mid Level Significant 0600Z</option>
                    <option value='https://aviationweather.gov/data/products/swm/12_sigwx_mid_nat.gif'>Mid Level Significant 1200Z</option>
                    <option value='https://aviationweather.gov/data/products/swm/18_sigwx_mid_nat.gif'>Mid Level Significant 1800Z</option>
                </select>
                <br><img id='weatherImageProg'><br>
            </div>
            <div id="windstemp" class="tab-pane fade">
                <h3>Winds/Temperature Charts</h3>
                <select class="selectpicker" id='type' name='type' data-mobile="true" onChange='updateImageWinds()'>
                    <OPTION VALUE='wind'>Wind Speed</OPTION>
                    <OPTION VALUE='temp'>Temperature</OPTION>
                    <OPTION VALUE='isa'>Temp. Difference</OPTION>
                    <OPTION VALUE='windstrm'>Streamlines</OPTION>
                </select>
                <select class="selectpicker" id='level' name='level' data-mobile="true"  onChange='updateImageWinds()'>
                    <OPTION VALUE='sfc'>sfc</OPTION>
                    <OPTION VALUE='900'>3,000</OPTION>
                    <OPTION VALUE='800'>6,000</OPTION>
                    <OPTION VALUE='725'>9,000</OPTION>
                    <OPTION VALUE='650'>12,000</OPTION>
                    <OPTION VALUE='575'>15,000</OPTION>
                    <OPTION VALUE='500'>FL180</OPTION>
                    <OPTION VALUE='400'>FL240</OPTION>
                    <OPTION VALUE='300'>FL300</OPTION>
                    <OPTION VALUE='225'>FL360</OPTION>
                    <OPTION VALUE='175'>FL420</OPTION>
                    <OPTION VALUE='125'>FL480</OPTION>
                </select>
                <select class="selectpicker" id='fore' name='fore' data-mobile="true"  onChange='updateImageWinds()'>
                    <option value='F00_rap'>0hr</option>
                    <option value='F01_rap'>1hr</option>
                    <option value='F02_rap'>2hr</option>
                    <option value='F03_rap'>3hr</option>
                    <option value='F04_rap'>4hr</option>
                    <option value='F05_rap'>5hr</option>
                    <option value='F06_rap'>6hr</option>
                    <option value='F07_rap'>7hr</option>
                    <option value='F08_rap'>8hr</option>
                    <option value='F09_rap'>9hr</option>
                    <option value='F10_rap'>10hr</option>
                    <option value='F11_rap'>11hr</option>
                    <option value='F12_rap'>12hr</option>
                    <option value='F13_rap'>13hr</option>
                    <option value='F14_rap'>14hr</option>
                    <option value='F15_rap'>15hr</option>
                    <option value='F16_rap'>16hr</option>
                    <option value='F17_rap'>17hr</option>
                    <option value='F18_rap'>18hr</option>
                </select>
                <br><img id='weatherImageWinds'><br>
            </div>
            <div id="turb" class="tab-pane fade">
                <h3>Turbulence Charts</h3>
                <select class="selectpicker" id='levelTurb' data-mobile="true"  name='levelTurb' onChange='updateImageTurb()'>
                    <OPTION VALUE='010'>1,000</OPTION>
                    <OPTION VALUE='030'>3,000</OPTION>
                    <OPTION VALUE='050'>5,000</OPTION>
                    <OPTION VALUE='070'>7,000</OPTION>
                    <OPTION VALUE='090'>9,000</OPTION>
                    <OPTION VALUE='110'>11,000</OPTION>
                    <OPTION VALUE='130'>13,000</OPTION>
                    <OPTION VALUE='150'>15,000</OPTION>
                    <OPTION VALUE='170'>17,000</OPTION>
                    <OPTION VALUE='190'>FL190</OPTION>
                    <OPTION VALUE='210'>FL210</OPTION>
                    <OPTION VALUE='230'>FL230</OPTION>
                    <OPTION VALUE='250'>FL250</OPTION>
                    <OPTION VALUE='270'>FL270</OPTION>
                    <OPTION VALUE='290'>FL290</OPTION>
                    <OPTION VALUE='310'>FL310</OPTION>
                    <OPTION VALUE='330'>FL330</OPTION>
                    <OPTION VALUE='350'>FL350</OPTION>
                    <OPTION VALUE='370'>FL370</OPTION>
                    <OPTION VALUE='390'>FL390</OPTION>
                    <OPTION VALUE='410'>FL410</OPTION>
                    <OPTION VALUE='430'>FL430</OPTION>
                    <OPTION VALUE='450'>FL450</OPTION>
                </select>
                <select class="selectpicker" id='foreTurb' data-mobile="true"  name='foreTurb' onChange='updateImageTurb()'>
                    <option value='00'>0hr</option>
                    <option value='01'>1hr</option>
                    <option value='02'>2hr</option>
                    <option value='03'>3hr</option>
                    <option value='06'>6hr</option>
                    <option value='09'>9hr</option>
                    <option value='12'>12hr</option>
                </select>
                <br><img id='weatherImageTurb'><br>
            </div>
            <div id="icing" class="tab-pane fade">
                <h3>Icing Charts</h3>
                <select class="selectpicker" id='typeIce' data-mobile="true"  name='typeIce' onChange='updateImageIcing()'>
                    <OPTION VALUE='sev'>Severity</OPTION>
                    <OPTION VALUE='sev25'>Severity(Prob>25%)</OPTION>
                    <OPTION VALUE='sev50'>Severity(Prob>50%)</OPTION>
                    <OPTION VALUE='prob'>Probability</OPTION>
                    <OPTION VALUE='frz'>Freezing Levels</OPTION>
                </select>
                <select class="selectpicker" id='levelIce' data-mobile="true"  name='levelIce' onChange='updateImageIcing()'>
                    <OPTION VALUE='010'>1,000</OPTION>
                    <OPTION VALUE='030'>3,000</OPTION>
                    <OPTION VALUE='050'>5,000</OPTION>
                    <OPTION VALUE='070'>7,000</OPTION>
                    <OPTION VALUE='090'>9,000</OPTION>
                    <OPTION VALUE='110'>11,000</OPTION>
                    <OPTION VALUE='130'>13,000</OPTION>
                    <OPTION VALUE='150'>15,000</OPTION>
                    <OPTION VALUE='170'>17,000</OPTION>
                    <OPTION VALUE='190'>FL190</OPTION>
                    <OPTION VALUE='210'>FL210</OPTION>
                    <OPTION VALUE='230'>FL230</OPTION>
                    <OPTION VALUE='250'>FL250</OPTION>
                    <OPTION VALUE='270'>FL270</OPTION>
                    <OPTION VALUE='290'>FL290</OPTION>
                    <OPTION VALUE='max'>max</OPTION>
                </select>
                <select class="selectpicker" id='foreIce' data-mobile="true"  name='foreIce' onChange='updateImageIcing()'>
                    <option value='00'>0hr</option>
                    <option value='02'>2hr</option>
                    <option value='03'>3hr</option>
                    <option value='06'>6hr</option>
                    <option value='09'>9hr</option>
                    <option value='12'>12hr</option>
                </select><br>
                <br><img id='weatherImageIcing'><br>
            </div>
            <div id="textual" class="tab-pane fade in active">
                <h3>Textual Weather/NOTAMS</h3><br>
                <a onclick="plan_get_weather()"><u>Get Briefing</u></a><br></br>
                <p id='plantable'></p>
            </div>
        </div>
    </div>


    <div id="help" class="tab-pane fade">
        <table class="table"><th>Plan Help</th>
        </table>
        <div  style="overflow: auto;">
            <u>You may need to disable Predictive Typing in Android Settings!</u><br>The Plan screen allows you to create and follow a basic flight plan with multiple way points. Way points are listed in the Plan, along with the total distance, time, course, fuel, and heading calculated from the current position to the final way point.<br>
            <br>
            <b>To Create a Flight Plan with Single Line Input</b>
            <ul>
                <li>Select the "New" tab.</li>
                <li>Enter a sentence of way points, separated by a single space like "KJFK LWM KBOS" in the "Create New Plan" box.</li>
                <li>Press the "Create" button to load the plan.</li>
                <li>Any way points not recognized, will be omitted.</li>
            </ul>

            <b>To Create a Flight Plan One Way Point at a Time</b>
            <ul>
                <li>Clear the current plan by pressing "Clr"</li>
                <li>Select the "Plan" tab.</li>
                <li>Enter a way point name (e.g. BOS) in the "Add To Plan" box, then press Search. If the point is valid, several options will be presented.</li>
                <li>Press Add button to the right of one of the presented options to add it to the end of the plan.</li>
                <li>Touch the added point in the "Plan" tab to move the green bar to it.</li>
                <li>Move the point to the desired sequence by pressing the Up or Down button several times.</li>
                <li>If a wrong point is added by mistake, it can be deleted by touching the point to move the green bar to it, then pressing the Delete button.</li>
            </ul>

            <b>To Save a Plan</b>
            <ul>
                <li>To save a plan, select the "Save" tab, enter the name to the left of "Save" button, and press the "Save" Button. The plan will be added to the plan list under the "Load" tab. Keep in mind that only 5 at a time are shown and you may have to page ahead to confirm that it was added successfully.</li>
            </ul>

            <b>To Load/Delete a Saved Plan</b>
            <ul>
                <li>Select the "Load" tab</li>
                <li>Press the "LD" or "LR" button to load the plan in the normal or reverse order.</li>
                <li>You can delete a saved plan by pressing the "Del" button to the right of its name in the Saved Plans list.</li>
                <li>If you have more plans saved than what can be shown in one list, use the "<" or ">" until you find it or enter the partial or full name of the desired plan in the "Plan Filter Spec." box, then press "Apply" to show it in the list.</li>
            </ul>

            <b>Saved Plans</b><br>
            This tab "Load" contains a list of flight plans that have been saved. They are listed in groups of 5 at a time.<br>
            <ul>
                <li>Use the "<" button to move to the previous page of plans.</li>
                <li>Use the ">" button to advance the list to the next page.</li>
                <li>The "<<" button will list the plans starting at the beginning.</li>
                <li>The "Last" button will show the plans at the end of the list.</li>
                <li>Using the "Apply" button will use the text entered into the "Plan Filter Spec" area to shorten the list of displayed plans to only those that contain the phrase entered here.</li>
                <li>Using empty filter will clear the filter and refresh the plan list.</li>
                <li>The "Refresh List" button will synchronize the displayed list with the flight plans in storage. This action will reflect any changes made by external apps on the plans.</li>
            </ul>

            <b>To Create a Flight Plan from Find Screen</b>
            <ul>
                <li>The Find screen can find cities, Geo. coordinates, addresses, and much more</li>
                <li>Go to Find Screen, and enter a location like "JFK" in the Search box</li>
                <li>Several options will be presented that match the word JFK.</li>
                <li>Long Press on the desired option, and some buttons will appear.</li>
                <li>Press the "+Plan" button to add the option to the end of the plan on the Plan screen.</li>
                <li>Follow the procedure -One Way Point at a Time- above to move the added way point to the desired location in the plan.</li>
            </ul>

            <b>To Create a Flight Plan from Map Screen</b>
            <ul>
                <li>Go to Map Screen, and long press anywhere on the map.</li>
                <li>A pop out will present "+Plan" button. Press the button to add the touched location in the plan on the Plan screen.</li>
                <li>Follow the procedure -One Way Point at a Time- above to move the added location to the desired location in the plan.</li>
            </ul>

            <!--
            <b>To Create a Plan Using SkyVector</b><br>
            <br>
            Avare can import flight plans that are created on your desktop PC or laptop using the web based
            application SkyVector. To start off, open a web browser to the SkyVector site at www.skyvector.com.
            The main interface presents you with a web page mainly made up of VFR sectionals. You can create a
            flight plan by right clicking on an airport, navaid, intersection, or just a generic GPS coordinate.
            You can also type the navaids/airports directly into the plan creator dialog.<br>
            <br>
            Once you have the plan created:
            <ul>
            <li>Click on the "Link" text at the top right. This will open a box with a prompt of "Plain Text Link". </li>
            <li>Copy all of the text from the Plain Text Link box.</li>
            <li>Place this text into a file. This will be your flight plan. Open your favorite text only editor
                and paste the link text into that file.	If your plan is large, it is probable that this text will
                scroll quite a bit to the right in the first line. Do not break this line up into smaller lines, it
                must be pasted without change. Save that file to disk, giving it a name - this will be the name of
                the flight plan. Ensure that the file name has a ".skv"	extension. This indicates to Avare that the
                file contains a SkyVector formatted flight plan.</li>
            <li>Copy this file from the local machine hard drive to your Android device. Ensure to copy it to the
                directory that you have configured for "User Defined Waypoints/Plans". To set or view this setting,
                within Avare, open the "Preferences", then select "Storage and Downloads", then "User Defined
                Waypoints/Plans".</li>
            <li>Once copied, head over to the Avare application and select the "Plan" tab, hit the "Refresh" button
                and you will see your new plan listed amongst the collection. Locate the plan of interest, using
                the "Next" and "Back" buttons as appropriate, then select "Load" to bring it into Avare.</li>
            <li>Press the "Inactive" button to now set the plan as active, then head back to the map/chart tab.</li>
            </ul>
            -->

            <b>To Simulate a Plan</b>
            <ul>
                <li>You can simulate a plan and show total distance and time from first way point point to the last way point with wind factored into the calculation.</li>
                <li>On the Map screen, press "Navigate" button on the right side slide out buttons to make it "Simulation"</li>
                <li>Go to Plan screen, and press the "Activate" button. Total distance and time of the plan will be shown in the Total row. Time is calculated from TAS specified Aircraft menu. Heading is calculated from wind speeds at the given altitude. User will need to download weather to see the heading.</li>
                <li>Change the altitude from drop down at the top of the Plan to use wind at that altitude.</li>
                <li>Move back to the Map screen to see the plan route in magenta.</li>
            </ul>

            <b>To Fly a Plan</b>
            <ul>
                <li>On the Map screen, press make sure that the "Navigate"/"Simulation" slide out button is in the "Navigate" state.</li>
                <li>Go to Plan screen, press the "Next"/"Previous" buttons to move the green bar to the second way point in the plan. Note: The first way point should be your departure airport.</li>
                <li>Press the "Inactive" button to make it "Active".</li>
                <li>The distance remaining, course, heading to the next way point, fuel burn, and ETE will be shown in the Total row when the plane is moving.</li>
                <li>Move back to the Map screen to see the plan route in magenta.</li>
            </ul>

            <b>Rubber Banding for Diversion</b>
            <ul>
                <li>Go to the Map screen while the plan is active.</li>
                <li>Grab the magenta by the green dot at the desired way point to be moved, then move the point to the desired location.</li>
                <li>The plan will update automatically.</li>
            </ul>

            <b>Sequencing on Flight</b>
            <ul>
                <li>Sequencing is on by default when the plan is active.</li>
                <li>If you pass within a certain distance of a way point that is selected by the green bar, the green bar will move to the next way point.</li>
                <li>If like to skip a way point, press the "Next" button to manually move the green bar to the next way point.</li>
            </ul>

            <b>De-activating a Flight Plan</b>
            <ul>
                <li>You can de-activate a flight by pressing "Active" button to make it "Inactive".</li>
                <li>Magenta on the map will disappear.</li>
                <li>If you choose to fly direct to a destination by choosing any direct functions from other screens, the plan will auto de-activate.</li>
            </ul>

            <b>Getting Plan Briefing</b>
            <ul>
                <li>Once a plan is entered, you can get the latest briefing for that plan area.</li>
                <li>Enter a plan with at least two points, at least one of which is an airport.</li>
                <li>Make sure you are connected to the Internet.</li>
                <li>Press "Get Briefing" link under the Brief tag.</li>
                <li>After a few seconds, the briefing will be shown.</li>
            </ul>

            <b>To Fill and File the Flight Plan Form</b>
            <ul>
                <li>Note: You can enter a plan in the Plan screen, then press the "Prepare" button to let the app fill the form. See Aircraft and Pilot under Aircraft for the form fields.</li>
                <li>Enter all the mandatory fields in the form. For example, enter Aircraft ID as N172EF, Flight Rule as VFR, Flight Type as General Aviation, No. of Aircraft as 1, Aircraft Type as C172, Wake Turbulence as Light, Aircraft Equipment as S, Departure as KBOS,
                    Departure Date Time(Zulu) as 2016-01-31 22:30,  Cruising Speed in knots as 110, Altitude in x100 feet as 045, Surveillance Equipment as N, Route as LWM, Destination as KJFK, Total Elapsed Time as 1H30M,
                    Alternate1 as KTEB, Alternate2 as KMMU, Fuel Endurance as 2H45M, People On Board as 2, Aircraft Color as W/B, Pilot in Command as Charles L, and Pilot Info as Charles L 202-267-8738. Note, if a departure/destination ICAO code is not available, enter ZZZZ in requisite field, then enter DEP / DEST in the Other Information Sub-field.</li>
                <li>Verify all information, then press the "File Plan" button to file the plan as described by the form.</li>
                <li>If the plan is filed, you will receive a success message. The freshly filed plan will appear under the "Filed Plans" list with state PROPOSED.</li>
            </ul>
            <b>To Load a Plan</b>
            <ul>
                <li>Filed plans can be loaded in the filing form in any state.</li>
                <li>Select the plan you want to load in the Filed Plans list by touching on it. The green bar will move to it.</li>
                <li>Press the "Load" button, and if the operation is successful, the plan will be loaded in the form as filed.</li>
                <li>Note: At this time, loading a filed plan into Plan screen is not supported.</li>
            </ul>
            <b>To Amend a Plan</b>
            <ul>
                <li>Filed plans can be amended when in PROPOSED state.</li>
                <li>Select the plan you want to amend in the Filed Plans list by touching on it. The green bar will move to it.</li>
                <li>Load it in the form by following the "To Load a Plan" procedure in this help.</li>
                <li>Modify the form as needed.</li>
                <li>Press the "Amend" button, and if the operation is successful, the plan will be amended.</li>
            </ul>
            <b>To Cancel the Filed Plan</b>
            <ul>
                <li>After filing the plan, its state changes to PROPOSED. You can cancel a plan only in PROPOSED state, before it is active.</li>
                <li>Select the plan you want to cancel in the Filed Plans list by touching on it. The green bar will move to it.</li>
                <li>Press the "Cancel" button, and if the cancel operation is successful, the plan will disappear from the Filed Plans list.</li>
            </ul>
            <b>To Activate a Filed Plan</b>
            <ul>
                <li>After filing the plan, its state changes to PROPOSED. You can activate a plan only in PROPOSED state.</li>
                <li>Select the plan you want to activate in the Filed Plans list by touching on it. The green bar will move to it.</li>
                <li>Select the time from now when you will take off from the drop down next to the "Activate Now" button.</li>
                <li>Press the "Activate Now" button, and if the activation is successful, the plan's state will change to ACTIVE.</li>
            </ul>
            <b>To Close an Active Plan</b>
            <ul>
                <li>After activating the plan, its state changes to ACTIVE. You can close a plan only in ACTIVE state.</li>
                <li>Select the plan you want to close in the Filed Plans list by touching on it. The green bar will move to it.</li>
                <li>If you are overdue, enter the location you are at in the box next to the "Close" button.</li>
                <li>Press the "Close" button, and if the close operation is successful, the plan will disappear from the Filed Plans list.</li>
                <li><b>We recommend that you call 1-800-WX-BRIEF to confirm that the plan is closed. If you forget to close an active plan, search and rescue may commence after you are OVERDUE, and you cannot be located.</b></li>
            </ul>
            <b>To Get Plan Briefing</b>
            <ul>
                <li>Select the plan you want to get briefing for in the Filed Plans list, by touching on it. The green bar will move to it.</li>
                <li>Press the "Get Email Briefing" button once.</li>
                <li>The briefing will be emailed to you at the address used for registering with Avare.</li>
                <li>Note: Route corridor width of 50 NM is used.</li>
            </ul>
            <b>To Get Plan Navigation Log</b>
            <ul>
                <li>You can get the navigation logs for an aircraft saved in the aircraft profiles at 1800wxbrief.com.</li>
                <li>Select the plan you want to get log for in the Filed Plans list, by touching on it. The green bar will move to it.</li>
                <li>Press the "Get Log" button once.</li>
                <li>The navigation log will appear at the bottom of the button.</li>
                <li>To clear the navigation log, press the "Clear Log" button.</li>
            </ul>
        </div>
    </div>
</div>
</body>
</html>